module Test where

import TambaraYamagami as TY
import Stringnet as S
import Data.Tree as T
import Data.Matrix as M

tree = fmap (\x -> case x of
                     Nothing -> "+"
                     Just e -> show e
            ) $ toTree finalMorphism

prin = (putStr. T.drawTree) tree

cList = toCompositionList finalMorphism

leaves = fmap (fmap substM) $ toTree finalMorphism

leftT (TensorM a b) = a
rightT (TensorM a b) = b

leftC (Compose a b) = a
rightC (Compose a b) = b

bad = Compose (AlphaI (Star (OVar RightLoop)) (OVar RightLoop) (Star One)) (Compose (RhoI (OVar RightLoop)) (Coev (OVar RightLoop)))

       

-- cList !! 3
-- big = TensorM (Compose (AlphaI (TensorO (TensorO (Star (OVar LeftLoop)) (OVar LeftLeg)) (OVar LeftLoop)) (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))) (OVar RightLoop)) (Compose (AlphaI (TensorO (Star (OVar LeftLoop)) (OVar LeftLeg)) (OVar LeftLoop) (TensorO (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))) (OVar RightLoop))) (Compose (AlphaI (Star (OVar LeftLoop)) (OVar LeftLeg) (TensorO (OVar LeftLoop) (TensorO (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))) (OVar RightLoop)))) (Compose (TensorM (Id (Star (OVar LeftLoop))) (TensorM (Id (OVar LeftLeg)) (TensorM (Id (OVar LeftLoop)) (AlphaI (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)) (OVar RightLoop))))) (Compose (TensorM (Id (Star (OVar LeftLoop))) (TensorM (Id (OVar LeftLeg)) (Alpha (OVar LeftLoop) (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (TensorO (Star (OVar RightLoop)) (OVar RightLoop))))) (Compose (TensorM (Id (Star (OVar LeftLoop))) (Alpha (OVar LeftLeg) (TensorO (OVar LeftLoop) (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop))) (TensorO (Star (OVar RightLoop)) (OVar RightLoop)))) (Compose (Alpha (Star (OVar LeftLoop)) (TensorO (OVar LeftLeg) (TensorO (OVar LeftLoop) (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)))) (TensorO (Star (OVar RightLoop)) (OVar RightLoop))) (Compose (TensorM (TensorM (Id (Star (OVar LeftLoop))) (TensorM (Id (OVar LeftLeg)) (Alpha (OVar LeftLoop) (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)))) (TensorM (Id (Star (OVar RightLoop))) (Id (OVar RightLoop)))) (Compose (TensorM (TensorM (Id (Star (OVar LeftLoop))) (Alpha (OVar LeftLeg) (TensorO (OVar LeftLoop) (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg)))) (OVar LeftLoop))) (TensorM (Id (Star (OVar RightLoop))) (Id (OVar RightLoop)))) (Compose (TensorM (Alpha (Star (OVar LeftLoop)) (TensorO (OVar LeftLeg) (TensorO (OVar LeftLoop) (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))))) (OVar LeftLoop)) (TensorM (Id (Star (OVar RightLoop))) (Id (OVar RightLoop)))) (Compose (TensorM (TensorM (TensorM (Id (Star (OVar LeftLoop))) (TensorM (Id (OVar LeftLeg)) (Alpha (OVar LeftLoop) (Star (OVar LeftLoop)) (Star (OVar LeftLeg))))) (Id (OVar LeftLoop))) (TensorM (Id (Star (OVar RightLoop))) (Id (OVar RightLoop)))) (Compose (TensorM (TensorM (TensorM (Id (Star (OVar LeftLoop))) (Alpha (OVar LeftLeg) (TensorO (OVar LeftLoop) (Star (OVar LeftLoop))) (Star (OVar LeftLeg)))) (Id (OVar LeftLoop))) (TensorM (Id (Star (OVar RightLoop))) (Id (OVar RightLoop)))) (Compose (Ev One) (TensorM (Compose (AlphaI (TensorO (Star (OVar LeftLoop)) (TensorO (TensorO (OVar LeftLeg) (TensorO (OVar LeftLoop) (Star (OVar LeftLoop)))) (Star (OVar LeftLeg)))) (OVar LeftLoop) One) (Compose (AlphaI (Star (OVar LeftLoop)) (TensorO (TensorO (OVar LeftLeg) (TensorO (OVar LeftLoop) (Star (OVar LeftLoop)))) (Star (OVar LeftLeg))) (TensorO (OVar LeftLoop) One)) (Compose (TensorM (Id (Star (OVar LeftLoop))) (Rho (TensorO (TensorO (TensorO (OVar LeftLeg) (TensorO (OVar LeftLoop) (Star (OVar LeftLoop)))) (Star (OVar LeftLeg))) (TensorO (OVar LeftLoop) One)))) (Compose (TensorM (Id (Star (OVar LeftLoop))) (TensorM (Id (TensorO (TensorO (TensorO (OVar LeftLeg) (TensorO (OVar LeftLoop) (Star (OVar LeftLoop)))) (Star (OVar LeftLeg))) (TensorO (OVar LeftLoop) One))) (Ev (OVar LeftLoop)))) (Compose (TensorM (Id (Star (OVar LeftLoop))) (Alpha (TensorO (TensorO (TensorO (OVar LeftLeg) (TensorO (OVar LeftLoop) (Star (OVar LeftLoop)))) (Star (OVar LeftLeg))) (TensorO (OVar LeftLoop) One)) (Star (OVar LeftLoop)) (OVar LeftLoop))) (Compose (TensorM (Id (Star (OVar LeftLoop))) (TensorM (Compose (AlphaI (TensorO (TensorO (OVar LeftLeg) (TensorO (OVar LeftLoop) (Star (OVar LeftLoop)))) (Star (OVar LeftLeg))) (TensorO (OVar LeftLoop) One) (Star (OVar LeftLoop))) (Compose (Ev One) (TensorM (Compose (AlphaI (TensorO (OVar LeftLeg) (TensorO (OVar LeftLoop) (Star (OVar LeftLoop)))) (Star (OVar LeftLeg)) One) (Compose (AlphaI (OVar LeftLeg) (TensorO (OVar LeftLoop) (Star (OVar LeftLoop))) (TensorO (Star (OVar LeftLeg)) One)) (Compose (TensorM (Id (OVar LeftLeg)) (Rho (TensorO (TensorO (OVar LeftLoop) (Star (OVar LeftLoop))) (TensorO (Star (OVar LeftLeg)) One)))) (Compose (TensorM (Id (OVar LeftLeg)) (TensorM (Id (TensorO (TensorO (OVar LeftLoop) (Star (OVar LeftLoop))) (TensorO (Star (OVar LeftLeg)) One))) (Ev (Star (OVar LeftLeg))))) (Compose (TensorM (Id (OVar LeftLeg)) (Alpha (TensorO (TensorO (OVar LeftLoop) (Star (OVar LeftLoop))) (TensorO (Star (OVar LeftLeg)) One)) (OVar LeftLeg) (Star (OVar LeftLeg)))) (Compose (TensorM (Id (OVar LeftLeg)) (TensorM (Compose (AlphaI (TensorO (OVar LeftLoop) (Star (OVar LeftLoop))) (TensorO (Star (OVar LeftLeg)) One) (OVar LeftLeg)) (Compose (Ev One) (TensorM (Compose (AlphaI (OVar LeftLoop) (Star (OVar LeftLoop)) One) (Compose (TensorM (Id (OVar LeftLoop)) (Rho (TensorO (Star (OVar LeftLoop)) One))) (Compose (TensorM (Id (OVar LeftLoop)) (TensorM (Id (TensorO (Star (OVar LeftLoop)) One)) (Ev (Star (OVar LeftLoop))))) (Compose (TensorM (Id (OVar LeftLoop)) (Alpha (TensorO (Star (OVar LeftLoop)) One) (OVar LeftLoop) (Star (OVar LeftLoop)))) (Compose (TensorM (Id (OVar LeftLoop)) (TensorM (Compose (RhoI (Star (OVar LeftLoop))) (Coev (OVar LeftLoop))) (Id (Star (OVar LeftLoop))))) (Compose (TensorM (PivotalJI (OVar LeftLoop)) (LambdaI (Star (OVar LeftLoop)))) (Coev (Star (OVar LeftLoop))))))))) (Compose (TensorM (Id (Star One)) (Rho (TensorO (TensorO (Star (OVar LeftLeg)) One) (OVar LeftLeg)))) (Compose (TensorM (Id (Star One)) (TensorM (Id (TensorO (TensorO (Star (OVar LeftLeg)) One) (OVar LeftLeg))) (Ev One))) (Compose (TensorM (Id (Star One)) (Alpha (TensorO (TensorO (Star (OVar LeftLeg)) One) (OVar LeftLeg)) (Star One) One)) (Compose (TensorM (Id (Star One)) (TensorM (Compose (AlphaI (TensorO (Star (OVar LeftLeg)) One) (OVar LeftLeg) (Star One)) (Compose (RhoI (Star (OVar LeftLeg))) (Compose (RhoI (OVar LeftLeg)) (Coev (OVar LeftLeg))))) (Id One))) (Compose (TensorM (PivotalJI (Star One)) (LambdaI One)) (Coev One))))))))) (Id (Star (OVar LeftLeg))))) (Compose (TensorM (PivotalJI (OVar LeftLeg)) (LambdaI (Star (OVar LeftLeg)))) (Coev (Star (OVar LeftLeg)))))))))) (Compose (TensorM (Id (Star One)) (Rho (TensorO (TensorO (OVar LeftLoop) One) (Star (OVar LeftLoop))))) (Compose (TensorM (Id (Star One)) (TensorM (Id (TensorO (TensorO (OVar LeftLoop) One) (Star (OVar LeftLoop)))) (Ev One))) (Compose (TensorM (Id (Star One)) (Alpha (TensorO (TensorO (OVar LeftLoop) One) (Star (OVar LeftLoop))) (Star One) One)) (Compose (TensorM (Id (Star One)) (TensorM (Compose (AlphaI (TensorO (OVar LeftLoop) One) (Star (OVar LeftLoop)) (Star One)) (Compose (AlphaI (OVar LeftLoop) One (TensorO (Star (OVar LeftLoop)) (Star One))) (Compose (TensorM (Id (OVar LeftLoop)) (Rho (TensorO One (TensorO (Star (OVar LeftLoop)) (Star One))))) (Compose (TensorM (Id (OVar LeftLoop)) (TensorM (Id (TensorO One (TensorO (Star (OVar LeftLoop)) (Star One)))) (Ev (Star (OVar LeftLoop))))) (Compose (TensorM (Id (OVar LeftLoop)) (Alpha (TensorO One (TensorO (Star (OVar LeftLoop)) (Star One))) (OVar LeftLoop) (Star (OVar LeftLoop)))) (Compose (TensorM (Id (OVar LeftLoop)) (TensorM (Compose (AlphaI One (TensorO (Star (OVar LeftLoop)) (Star One)) (OVar LeftLoop)) (Compose (TensorM (Id One) (Rho (TensorO (TensorO (Star (OVar LeftLoop)) (Star One)) (OVar LeftLoop)))) (Compose (TensorM (Id One) (TensorM (Id (TensorO (TensorO (Star (OVar LeftLoop)) (Star One)) (OVar LeftLoop))) (Ev (Star One)))) (Compose (TensorM (Id One) (Alpha (TensorO (TensorO (Star (OVar LeftLoop)) (Star One)) (OVar LeftLoop)) One (Star One))) (Compose (TensorM (Id One) (TensorM (Compose (AlphaI (TensorO (Star (OVar LeftLoop)) (Star One)) (OVar LeftLoop) One) (Compose (RhoI (OVar LeftLoop)) (Compose (RhoI (Star (OVar LeftLoop))) (Coev (OVar LeftLoop))))) (Id (Star One)))) (Compose (TensorM (PivotalJI One) (LambdaI (Star One))) (Coev (Star One)))))))) (Id (Star (OVar LeftLoop))))) (Compose (TensorM (PivotalJI (OVar LeftLoop)) (LambdaI (Star (OVar LeftLoop)))) (Coev (Star (OVar LeftLoop)))))))))) (Id One))) (Compose (TensorM (PivotalJI (Star One)) (LambdaI One)) (Coev One))))))))) (Id (OVar LeftLoop)))) (Compose (TensorM (PivotalJI (Star (OVar LeftLoop))) (LambdaI (OVar LeftLoop))) (Coev (OVar LeftLoop))))))))) (Compose (TensorM (Id (Star One)) (Rho (TensorO (Star (OVar RightLoop)) (OVar RightLoop)))) (Compose (TensorM (Id (Star One)) (TensorM (Id (TensorO (Star (OVar RightLoop)) (OVar RightLoop))) (Ev One))) (Compose (TensorM (Id (Star One)) (Alpha (TensorO (Star (OVar RightLoop)) (OVar RightLoop)) (Star One) One)) (Compose (TensorM (Id (Star One)) (TensorM (Compose (AlphaI (Star (OVar RightLoop)) (OVar RightLoop) (Star One)) (Compose (RhoI (OVar RightLoop)) (Coev (OVar RightLoop)))) (Id One))) (Compose (TensorM (PivotalJI (Star One)) (LambdaI One)) (Coev One)))))))))))))))))))) (Compose (TensorM (Id (Star (OVar RightLoop))) (Rho (TensorO (OVar RightLeg) (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))))) (Compose (TensorM (Id (Star (OVar RightLoop))) (TensorM (Id (TensorO (OVar RightLeg) (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))))) (Ev (OVar RightLoop)))) (Compose (TensorM (Id (Star (OVar RightLoop))) (Alpha (TensorO (OVar RightLeg) (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))) (Star (OVar RightLoop)) (OVar RightLoop))) (Compose (TensorM (Id (Star (OVar RightLoop))) (TensorM (Compose (AlphaI (OVar RightLeg) (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))) (Star (OVar RightLoop))) (Compose (TensorM (Id (OVar RightLeg)) (Rho (TensorO (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))) (Star (OVar RightLoop))))) (Compose (TensorM (Id (OVar RightLeg)) (TensorM (Id (TensorO (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))) (Star (OVar RightLoop)))) (Ev (Star (OVar RightLeg))))) (Compose (TensorM (Id (OVar RightLeg)) (Alpha (TensorO (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))) (Star (OVar RightLoop))) (OVar RightLeg) (Star (OVar RightLeg)))) (Compose (TensorM (Id (OVar RightLeg)) (TensorM (Compose (AlphaI (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))) (Star (OVar RightLoop)) (OVar RightLeg)) (Compose (TensorM (Id (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))) (Rho (TensorO (Star (OVar RightLoop)) (OVar RightLeg)))) (Compose (TensorM (Id (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))) (TensorM (Id (TensorO (Star (OVar RightLoop)) (OVar RightLeg))) (Ev (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))))) (Compose (TensorM (Id (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))) (Alpha (TensorO (Star (OVar RightLoop)) (OVar RightLeg)) (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))) (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))) (Compose (TensorM (Id (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))) (TensorM (Compose (AlphaI (Star (OVar RightLoop)) (OVar RightLeg) (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))) (Compose (TensorM (Id (Star (OVar RightLoop))) (Alpha (OVar RightLeg) (OVar RightLoop) (Star (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop))))) (Compose (Alpha (Star (OVar RightLoop)) (TensorO (OVar RightLeg) (OVar RightLoop)) (Star (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)))) Phi))) (Id (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))))) (Compose (TensorM (PivotalJI (Star (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))) (LambdaI (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop))))) (Coev (TensorO (TensorO (TensorO (Star (OVar LeftLoop)) (Star (OVar LeftLeg))) (OVar LeftLoop)) (Star (OVar RightLoop)))))))))) (Id (Star (OVar RightLeg))))) (Compose (TensorM (PivotalJI (OVar RightLeg)) (LambdaI (Star (OVar RightLeg)))) (Coev (Star (OVar RightLeg))))))))) (Id (OVar RightLoop)))) (Compose (TensorM (PivotalJI (Star (OVar RightLoop))) (LambdaI (OVar RightLoop))) (Coev (OVar RightLoop)))))))

small = (Compose (TensorM (PivotalJI (Star (OVar RightLoop))) (LambdaI (OVar RightLoop))) (Coev (OVar RightLoop)))


